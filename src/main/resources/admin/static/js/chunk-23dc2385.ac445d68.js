(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-23dc2385"],{"167c":function(t,e,a){},a434:function(t,e,a){"use strict";var n=a("23e7"),i=a("23cb"),c=a("a691"),r=a("50c4"),s=a("7b0b"),o=a("65f0"),l=a("8418"),u=a("1dde"),d=a("ae40"),m=u("splice"),h=d("splice",{ACCESSORS:!0,0:0,1:2}),p=Math.max,f=Math.min,b=9007199254740991,g="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!m||!h},{splice:function(t,e){var a,n,u,d,m,h,v=s(this),y=r(v.length),x=i(t,y),L=arguments.length;if(0===L?a=n=0:1===L?(a=0,n=y-x):(a=L-2,n=f(p(c(e),0),y-x)),y+a-n>b)throw TypeError(g);for(u=o(v,n),d=0;d<n;d++)m=x+d,m in v&&l(u,d,v[m]);if(u.length=n,a<n){for(d=x;d<y-n;d++)m=d+n,h=d+a,m in v?v[h]=v[m]:delete v[h];for(d=y;d>y-n+a;d--)delete v[d-1]}else if(a>n)for(d=y-n;d>x;d--)m=d+n-1,h=d+a-1,m in v?v[h]=v[m]:delete v[h];for(d=0;d<a;d++)v[d+x]=arguments[d+2];return v.length=y-n+a,u}})},a6915:function(t,e,a){"use strict";a("c747")},a796:function(t,e,a){"use strict";a.d(e,"e",(function(){return r})),a.d(e,"c",(function(){return s})),a.d(e,"d",(function(){return o})),a.d(e,"i",(function(){return l})),a.d(e,"h",(function(){return u})),a.d(e,"f",(function(){return d})),a.d(e,"a",(function(){return m})),a.d(e,"b",(function(){return h})),a.d(e,"g",(function(){return p}));a("99af");var n=a("b775"),i=a("ed08"),c="/api/admin/attachment";function r(t){return Object(n["a"])({url:"".concat(c,"/list"),method:"post",data:t})}function s(){return Object(n["a"])({url:"".concat(c,"/list/type"),method:"get"})}function o(){return Object(n["a"])({url:"".concat(c,"/list/team"),method:"get"})}var l="".concat("").concat(c,"/upload");function u(t){return Object(n["a"])({url:"".concat(c,"/upload"),method:"post",headers:{"Content-Type":"multipart/form-data"},data:Object(i["b"])(t)})}function d(t){return Object(n["a"])({url:"".concat(c,"/update"),method:"post",data:t})}function m(t){return Object(n["a"])({url:"".concat(c,"/delete/").concat(t),method:"delete"})}function h(t){return Object(n["a"])({url:"".concat(c,"/delete"),method:"delete",data:t})}function p(t){return Object(n["a"])({url:"".concat(c,"/update/team"),method:"post",headers:{"Content-Type":"multipart/form-data"},data:Object(i["b"])(t)})}},c747:function(t,e,a){},d3aa:function(t,e,a){"use strict";a("167c")},f6ba:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"search-box"},[a("el-form",{ref:"searchParamsForm",attrs:{inline:!0,model:t.searchParams,size:"small"}},[a("el-form-item",{attrs:{label:"关键词：",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入关键词"},model:{value:t.searchParams.name,callback:function(e){t.$set(t.searchParams,"name",e)},expression:"searchParams.name"}})],1),a("el-form-item",{attrs:{label:"类型：",prop:"mediaType"}},[a("el-select",{staticStyle:{width:"160px"},attrs:{filterable:""},model:{value:t.searchParams.mediaType,callback:function(e){t.$set(t.searchParams,"mediaType",e)},expression:"searchParams.mediaType"}},t._l(t.mediaTypeList,(function(t,e){return a("el-option",{key:e,attrs:{value:t,label:t}})})),1)],1),a("el-form-item",{attrs:{label:"分组：",prop:"team"}},[a("el-select",{staticStyle:{width:"200px"},attrs:{filterable:"","default-first-option":""},model:{value:t.searchParams.team,callback:function(e){t.$set(t.searchParams,"team",e)},expression:"searchParams.team"}},[a("el-option",{staticStyle:{"font-style":"italic"},attrs:{label:"默认分组",value:""}}),t._l(t.teamList,(function(t,e){return a("el-option",{key:e,attrs:{label:t,value:t}})}))],2)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.getAttachmentList}},[t._v("查 询")]),a("el-button",{on:{click:function(e){return t.resetSearchParams("searchParamsForm")}}},[t._v("重 置")])],1)],1)],1),a("div",{staticStyle:{"margin-bottom":"20px"}},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-upload"},on:{click:function(e){t.uploadDialog=!0}}},[t._v("上传附件")]),t.batchOperation?a("span",[a("el-popover",{staticStyle:{"margin-left":"10px"},attrs:{placement:"top-start",title:"移动到分组",trigger:"click"},on:{hide:function(e){t.batchMoveTeamName=""}}},[a("el-select",{staticStyle:{width:"200px"},attrs:{size:"small",filterable:"","allow-create":"","default-first-option":""},model:{value:t.batchMoveTeamName,callback:function(e){t.batchMoveTeamName=e},expression:"batchMoveTeamName"}},[a("el-option",{staticStyle:{"font-style":"italic"},attrs:{label:"默认分组",value:""}}),t._l(t.teamList,(function(t,e){return a("el-option",{key:e,attrs:{label:t,value:t}})}))],2),a("div",{staticStyle:{"text-align":"right","margin-top":"10px"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.batchMoveTeam}},[t._v("保存")])],1),a("el-button",{attrs:{slot:"reference",type:"info",size:"small",icon:"el-icon-folder"},slot:"reference"},[t._v("分组")])],1),a("el-popconfirm",{staticStyle:{"margin-left":"10px"},attrs:{placement:"top-start","confirm-button-text":"确定","cancel-button-text":"取消",icon:"el-icon-info","icon-color":"red",title:"您要永久删除这些附件吗？"},on:{confirm:t.deleteAttachments}},[a("el-button",{attrs:{slot:"reference",type:"danger",size:"small",icon:"el-icon-delete"},slot:"reference"},[t._v("删 除")])],1),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",icon:"el-icon-close"},on:{click:t.cancelBatchDelete}},[t._v("取 消")])],1):a("el-button",{attrs:{size:"small",icon:"el-icon-s-release"},on:{click:function(e){t.batchOperation=!t.batchOperation}}},[t._v(" 批量操作 ")])],1),a("div",[0===t.attachmentList.length?a("v-empty-data",{staticStyle:{width:"100px"}}):t._e(),a("el-checkbox-group",{model:{value:t.batchIds,callback:function(e){t.batchIds=e},expression:"batchIds"}},[a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],attrs:{gutter:20}},t._l(t.attachmentList,(function(e,n){return a("el-col",{key:e.id,attrs:{xs:6,sm:4}},[a("div",{staticClass:"attachment-item"},[t.batchOperation?a("el-checkbox",{staticClass:"check-box",attrs:{label:e.id}}):t._e(),a("div",{staticClass:"img",on:{click:function(e){t.batchOperation?t.batchDeleteChecked(n):t.openDetailDrawer(n)}}},[a("v-image",{attrs:{src:t.baseUrl+e.thumbPath,alt:e.name}},[a("div",{attrs:{slot:"error"},slot:"error"},[-1!==e.mediaType.search("image")?a("i",{staticClass:"el-icon-picture-outline"}):a("span",[t._v(t._s(e.mediaType))])])])],1),a("div",{staticClass:"name",attrs:{title:e.name}},[t._v(t._s(e.name))])],1)])})),1)],1)],1),t.total>0?a("div",{staticStyle:{"margin-top":"20px","text-align":"center"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.searchParams.pageSize,"current-page":t.searchParams.current},on:{"update:pageSize":function(e){return t.$set(t.searchParams,"pageSize",e)},"update:page-size":function(e){return t.$set(t.searchParams,"pageSize",e)},"update:currentPage":function(e){return t.$set(t.searchParams,"current",e)},"update:current-page":function(e){return t.$set(t.searchParams,"current",e)},"current-change":t.getAttachmentList,"size-change":t.getAttachmentList}})],1):t._e(),a("el-drawer",{attrs:{visible:t.detailDrawer,direction:"rtl","destroy-on-close":"",title:"附件详情"},on:{"update:visible":function(e){t.detailDrawer=e}}},[a("v-detail-drawer",{ref:"detailDrawer",staticStyle:{padding:"0 20px 70px 20px"}}),a("div",{staticClass:"footer-toolbar",staticStyle:{width:"30%"}},[a("el-popconfirm",{attrs:{placement:"top-start","confirm-button-text":"确定","cancel-button-text":"取消",icon:"el-icon-info","icon-color":"red",title:"您要永久删除附件【"+t.currentName+"】吗？"},on:{confirm:t.deleteAttachment}},[a("el-button",{attrs:{slot:"reference",type:"danger",size:"medium"},slot:"reference"},[t._v("删 除")])],1)],1)],1),a("el-dialog",{attrs:{title:"上传附件",visible:t.uploadDialog,"destroy-on-close":"",width:"30vw"},on:{"update:visible":function(e){t.uploadDialog=e},close:t.getAttachmentList}},[a("v-upload")],1)],1)},i=[],c=(a("d3b7"),a("3ca3"),a("ddb0"),a("b0c0"),a("a434"),a("4de4"),a("a796")),r={name:"Attachment",components:{"v-image":function(){return a.e("chunk-45a23f59").then(a.bind(null,"05f1"))},"v-empty-data":function(){return a.e("chunk-2752c4d3").then(a.bind(null,"4388"))},"v-detail-drawer":function(){return a.e("chunk-50fe81c4").then(a.bind(null,"a607"))},"v-upload":function(){return a.e("chunk-4d7828da").then(a.bind(null,"8335"))}},data:function(){return{searchParams:{current:1,pageSize:18,name:"",mediaType:null,team:null},total:0,mediaTypeList:[],teamList:[],attachmentList:[],batchIds:[],listLoading:!1,detailDrawer:!1,uploadDialog:!1,batchOperation:!1,currentIndex:0,batchMoveTeamName:""}},computed:{currentName:function(){return this.attachmentList[this.currentIndex]?this.attachmentList[this.currentIndex].name:""}},created:function(){this.getMediaTypeList(),this.getTeamList(),this.getAttachmentList()},methods:{resetSearchParams:function(t){this.$refs[t].resetFields(),this.searchParams.current=1,this.getAttachmentList()},openDetailDrawer:function(t){var e=this;this.currentIndex=t,this.detailDrawer=!0;var a=this.attachmentList[t];setTimeout((function(){e.$refs.detailDrawer.setData(a)}),200)},batchDeleteChecked:function(t){var e=this.attachmentList[t].id,a=this.batchIds.indexOf(e);a<0?this.batchIds.push(e):this.batchIds.splice(a,1)},cancelBatchDelete:function(){this.batchOperation=!this.batchOperation,this.batchIds=[]},getAttachmentList:function(){var t=this;this.listLoading=!0,Object(c["e"])(this.searchParams).then((function(e){t.total=e.data.total,t.attachmentList=e.data.list,t.listLoading=!1})).catch((function(){t.listLoading=!1}))},getMediaTypeList:function(){var t=this;Object(c["c"])().then((function(e){t.mediaTypeList=e.data}))},getTeamList:function(){var t=this;Object(c["d"])().then((function(e){t.teamList=e.data.filter((function(t){return!!t}))}))},deleteAttachment:function(){var t=this,e=this.attachmentList[this.currentIndex].id;Object(c["a"])(e).then((function(e){t.detailDrawer=!1,t.$message.success(e.message),t.getAttachmentList()}))},deleteAttachments:function(){var t=this;this.batchIds.length<1?this.$message.info("您未选择附件"):Object(c["b"])(this.batchIds).then((function(e){t.batchOperation=!1,t.$message.success(e.message),t.getAttachmentList()}))},batchMoveTeam:function(){var t=this;this.batchIds.length<1?this.$message.info("您未选择附件"):Object(c["g"])({ids:this.batchIds,team:this.batchMoveTeamName}).then((function(e){t.batchOperation=!1,t.$message.success(e.message),t.getAttachmentList()}))}}},s=r,o=(a("a6915"),a("d3aa"),a("2877")),l=Object(o["a"])(s,n,i,!1,null,"32b85ae8",null);e["default"]=l.exports}}]);