(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-608d7545"],{"5b49":function(t,e,a){},"7f1e":function(t,e,a){"use strict";a("5b49")},"9a83":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{xs:24,sm:9}},[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[t._v(t._s(t.isAdd?"添加":"修改")+"友链")]),a("el-form",{attrs:{"label-position":"top",model:t.addOrUpdateData,size:"small"}},[a("el-form-item",{attrs:{label:"友链名称：",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入友链名称"},model:{value:t.addOrUpdateData.name,callback:function(e){t.$set(t.addOrUpdateData,"name",e)},expression:"addOrUpdateData.name"}})],1),a("el-form-item",{attrs:{label:"友链链接：",prop:"url"}},[a("el-input",{attrs:{placeholder:"请附带http[s]://前缀"},nativeOn:{"!blur":function(e){t.checkUrl(),t.setUrlLogoParser()}},model:{value:t.addOrUpdateData.url,callback:function(e){t.$set(t.addOrUpdateData,"url",e)},expression:"addOrUpdateData.url"}})],1),a("el-form-item",{staticStyle:{position:"relative"},attrs:{label:"Logo链接：",prop:"logo"}},[a("el-input",{attrs:{placeholder:"请输入友链Logo链接",disabled:"api"===t.logoType},model:{value:t.addOrUpdateData.logo,callback:function(e){t.$set(t.addOrUpdateData,"logo",e)},expression:"addOrUpdateData.logo"}},[a("el-avatar",{staticStyle:{"vertical-align":"middle","margin-bottom":"2px"},attrs:{slot:"prefix",shape:"square",size:18,fit:"cover",src:t.addOrUpdateData.logo},slot:"prefix"},[t._t("error",[t._v("ico")])],2)],1),a("el-radio-group",{staticClass:"link-logo-type",on:{change:t.logoTypeChange},model:{value:t.logoType,callback:function(e){t.logoType=e},expression:"logoType"}},[a("el-radio",{attrs:{label:"api"}},[t._v("使用API解析")]),a("el-radio",{attrs:{label:"custom"}},[t._v("自定义")])],1)],1),a("el-form-item",{attrs:{label:"友链排名：",prop:"topRank"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right"},model:{value:t.addOrUpdateData.topRank,callback:function(e){t.$set(t.addOrUpdateData,"topRank",e)},expression:"addOrUpdateData.topRank"}}),a("p",{staticClass:"input-tips"},[t._v("* 值越大越靠前")])],1),a("el-form-item",{attrs:{label:"描述：",prop:"description"}},[a("el-input",{attrs:{rows:3,type:"textarea",placeholder:"描述一下友链"},model:{value:t.addOrUpdateData.description,callback:function(e){t.$set(t.addOrUpdateData,"description",e)},expression:"addOrUpdateData.description"}})],1),a("el-form-item",[a("el-button-group",[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.isAdd?t.addLink():t.updateLink()}}},[t._v(" "+t._s(t.isAdd?"保 存":"更 新")+" ")]),t.isAdd?t._e():a("el-button",{on:{click:t.resetForm}},[t._v("返回添加")])],1)],1)],1)],1)],1),a("el-col",{attrs:{xs:24,sm:15}},[a("el-card",[a("div",{attrs:{slot:"header"},slot:"header"},[t._v("友链列表")]),a("div",{staticClass:"search-box"},[a("el-form",{ref:"searchParamsForm",attrs:{inline:!0,model:t.searchParams,size:"small"}},[a("el-form-item",{attrs:{label:"关键字：",prop:"keyword"}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入名称或URL搜索"},model:{value:t.searchParams.keyword,callback:function(e){t.$set(t.searchParams,"keyword",e)},expression:"searchParams.keyword"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.getLinkList}},[t._v("查 询")]),a("el-button",{on:{click:function(e){return t.resetSearchParams("searchParamsForm")}}},[t._v("重 置")])],1),a("el-form-item",{staticStyle:{float:"right"}},[a("el-button",{attrs:{type:"success"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("修改Logo解析API")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableDataLoading,expression:"tableDataLoading"}],ref:"blogListTable",attrs:{data:t.linkList,"tooltip-effect":"dark","header-cell-style":{fontWeight:"normal",color:"#666"}}},[a("el-table-column",{attrs:{prop:"name",label:"图标",width:"52",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-avatar",{staticStyle:{"vertical-align":"middle","margin-bottom":"2px"},attrs:{slot:"prefix",shape:"square",size:24,fit:"cover",src:e.row.logo},slot:"prefix"},[t._t("error",[t._v("ico")])],2)]}}],null,!0)}),a("el-table-column",{attrs:{prop:"name",label:"名称",width:"180","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-link",{attrs:{target:"_blank",type:"primary",href:e.row.url,underline:!1}},[t._v(" "+t._s(e.row.name)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"topRank",label:"排名",width:"100"}}),a("el-table-column",{attrs:{prop:"description",label:"描述","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"操作",width:"131",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button-group",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return t.tryUpdate(e.$index)}}},[t._v("编辑")]),a("el-popconfirm",{attrs:{placement:"top-start","confirm-button-text":"确定","cancel-button-text":"取消",icon:"el-icon-info","icon-color":"red",title:"您要永久删除友链【"+e.row.name+"】吗？"},on:{confirm:function(a){return t.deleteLink(e.$index)}}},[a("el-button",{attrs:{slot:"reference",type:"danger",size:"mini"},slot:"reference"},[t._v("删除")])],1)],1)]}}])})],1),a("div",{staticClass:"clearfix"},[a("div",{staticClass:"pagination "},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.searchParams.pageSize,"current-page":t.searchParams.current},on:{"update:pageSize":function(e){return t.$set(t.searchParams,"pageSize",e)},"update:page-size":function(e){return t.$set(t.searchParams,"pageSize",e)},"update:currentPage":function(e){return t.$set(t.searchParams,"current",e)},"update:current-page":function(e){return t.$set(t.searchParams,"current",e)},"current-change":t.getLinkList,"size-change":t.getLinkList}})],1)])],1)],1)],1),a("el-dialog",{attrs:{title:"修改友链Logo解析API",visible:t.dialogVisible,width:"36vw"},on:{"update:visible":function(e){t.dialogVisible=e},closed:function(e){t.urlLogoParser=t.options["url_favicon_parser"]}}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入友链Logo解析API"},model:{value:t.urlLogoParser,callback:function(e){t.urlLogoParser=e},expression:"urlLogoParser"}}),a("div",{staticStyle:{color:"#97a8be","font-size":"12px","line-height":"150%","margin-top":"10px"}},[a("div",[t._v("说明：")]),a("div",{staticStyle:{"padding-left":"2rem"}},[a("div",[t._v('在API链接中插入"{}"符号，代表该友链链接')]),a("div",[t._v("如果缺省，默认在API链接后面追加")])]),a("div",[t._v("示例：")]),a("div",{staticStyle:{"padding-left":"2rem"}},[a("div",[t._v('如输入的解析API为"https://www.google.cn/s2/favicons?domain={}"')]),a("div",[t._v('若友链为"https://www.baidu.com/"')]),a("div",[t._v('则解析成"https://www.google.cn/s2/favicons?domain=https://www.baidu.com/"')])])]),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.updateUrlLogoParser}},[t._v("保 存")])],1)],1)],1)},o=[],i=a("5530"),s=(a("ac1f"),a("00b4"),a("4d63"),a("2c3e"),a("25f0"),a("5319"),a("99af"),a("b775")),n="/api/admin/link";function l(t){return Object(s["a"])({url:"".concat(n,"/list"),method:"post",data:t})}function c(t){return Object(s["a"])({url:"".concat(n,"/update"),method:"post",data:t})}function d(t){return Object(s["a"])({url:"".concat(n,"/delete/").concat(t),method:"delete"})}function p(t){return Object(s["a"])({url:"".concat(n,"/add"),method:"post",data:t})}function u(t){return Object(s["a"])({url:"".concat(n,"/update/parser"),method:"post",data:t})}var m=a("2f62"),g=a("ed08"),f={name:"Link",data:function(){return{searchParams:{current:1,pageSize:10,keyword:""},total:0,linkList:[],tableDataLoading:!1,isAdd:!0,logoType:"api",addOrUpdateData:{name:"",url:"",logo:"",topRank:0,description:""},urlLogoParser:"",dialogVisible:!1}},computed:Object(i["a"])({},Object(m["b"])(["options"])),created:function(){this.getLinkList(),this.urlLogoParser=this.options["url_favicon_parser"]||""},methods:{resetForm:function(){this.isAdd=!0,this.addOrUpdateData={name:"",url:"",logo:"",topRank:0,description:""}},resetSearchParams:function(t){this.$refs[t].resetFields(),this.searchParams.current=1,this.getLinkList()},operationSuccess:function(t){this.$message.success(t),this.getLinkList(),this.resetForm()},tryUpdate:function(t){this.isAdd=!1,this.addOrUpdateData=Object(i["a"])({},this.linkList[t])},checkUrl:function(){var t=this.addOrUpdateData.url||"";new RegExp("^https?://").test(t)||(this.addOrUpdateData.url="http://"+t)},setUrlLogoParser:function(){"api"===this.logoType&&(new RegExp(".*{}.*").test(this.urlLogoParser)?this.addOrUpdateData.logo=this.urlLogoParser.replace("{}",this.addOrUpdateData.url):this.addOrUpdateData.logo+=this.addOrUpdateData.url)},logoTypeChange:function(t){switch(t){case"api":this.setUrlLogoParser();break;case"custom":break}},getLinkList:function(){var t=this;this.tableDataLoading=!0,l(this.searchParams).then((function(e){t.total=e.data.total,t.linkList=e.data.list,t.tableDataLoading=!1})).catch((function(){t.tableDataLoading=!1}))},deleteLink:function(t){var e=this,a=this.linkList[t].id;d(a).then((function(t){e.operationSuccess(t.message)}))},addLink:function(){var t=this;p(this.addOrUpdateData).then((function(e){t.operationSuccess(e.message)}))},updateLink:function(){var t=this;c(this.addOrUpdateData).then((function(e){t.operationSuccess(e.message)}))},updateUrlLogoParser:function(){var t=this;u(Object(g["b"])({parser:this.urlLogoParser})).then((function(e){t.$message.success(e.message),t.dialogVisible=!1;var a=t.options;a["url_favicon_parser"]=t.urlLogoParser,t.$store.dispatch("option/changeOptions",a),"api"===t.logoType&&t.addOrUpdateData.url&&t.setUrlLogoParser(),t.getLinkList()}))}}},h=f,b=(a("e385"),a("7f1e"),a("2877")),v=Object(b["a"])(h,r,o,!1,null,"1bc934b6",null);e["default"]=v.exports},"9c2f":function(t,e,a){},e385:function(t,e,a){"use strict";a("9c2f")}}]);